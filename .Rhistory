facet_grid("tissue" + "gene" ~., scales = 'free_x', space = 'free_x') +
theme_bw() +
theme(legend.position="none", strip.text.y = element_blank()) +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in 1:10){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 10))
plot_grid(bp_list[[1]], bp_list[[2]], ncol = 1, align = "h", axis = "tblr")
## 02. MC-TC identified genes
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c( "tissue", "gene"), color = "gene") +
facet_grid(scales = 'free_x', space = 'free_x') +
theme_bw() +
theme(legend.position="none", strip.text.y = element_blank()) +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in 1:10){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 10))
plot_grid(bp_list[[1]], bp_list[[2]], ncol = 1, align = "h", axis = "tblr")
bp1
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c( "tissue", "gene"), color = "gene") +
facet_grid(scales = 'free_x', space = 'free_x') +
theme_bw() +
theme(legend.position="none", strip.text.y = element_blank()) +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in 1:10){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 10))
plot_grid(bp_list[[1]], bp_list[[2]], ncol = 1, align = "h", axis = "tblr")
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c( "tissue", "gene"), color = "gene") +
theme_bw() +
theme(legend.position="none", strip.text.y = element_blank()) +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in 1:10){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 10))
plot_grid(bp_list[[1]], bp_list[[2]], ncol = 1, align = "h", axis = "tblr")
plot_grid(bp_list[[1]], bp_list[[2]], ncol = 1, align = "h", axis = "tblr")
plot_grid(bp1, bp2, ncol = 1, align = "h", axis = "tblr")
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
plot_grid(bp1, bp2, ncol = 1, align = "h", axis = "tblr")
bp_list[[3]]
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
tissue
gene_map <- select(org.Mm.eg.db, keys=colnames(agemap_data_list[[1]]),
columns=c("GENENAME","SYMBOL"), keytype="UNIGENE")
library(ggpubr)
library(org.Mm.eg.db)
gene_map <- select(org.Mm.eg.db, keys=colnames(agemap_data_list[[1]]),
columns=c("GENENAME","SYMBOL"), keytype="UNIGENE")
tissue
tissue$gene
levels(tissue$gene()
)
tissue$gene
gene_map
View(gene_map)
match(tissue$gene,gene_map$UNIGENE)
gene_map$SYMBOL[match(tissue$gene,gene_map$UNIGENE)]
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
tissue$gene = gene_map$SYMBOL[match(tissue$gene,gene_map$UNIGENE)]
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c( "tissue", "gene"), color = "gene") +
theme_bw() +
theme(legend.position="none", strip.text.y = element_blank()) +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in 1:10){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
i
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
tissue$gene = gene_map$SYMBOL[match(tissue$gene,gene_map$UNIGENE)]
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c( "tissue", "gene"), color = "gene") +
theme_bw() +
theme(legend.position="none", strip.text.y = element_blank()) +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in c(1:8,10)){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
# tissue$gene = gene_map$SYMBOL[match(tissue$gene,gene_map$UNIGENE)]
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c( "tissue", "gene"), color = "gene") +
theme_bw() +
theme(legend.position="none", strip.text.y = element_blank()) +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in c(1:8,10)){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 5))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
?plot_grid
grp_name
grp_name[,1]
grep(grp_name[,1], sep = "X")
paste0(grp_name[,1], sep = "X")
paste(grp_name[,1], sep = "X")
grp_name
grp_name[,1]
paste(grp_name[,1], collapse = "X")
paste(grp_name[,1], collapse = " X ")
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0), labels = c(paste(grp_name[,1], collapse = " X "), NA))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0), labels = c(paste(grp_name[,1], collapse = " X ")))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
bp1
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
# tissue$gene = gene_map$SYMBOL[match(tissue$gene,gene_map$UNIGENE)]
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c( "tissue", "gene"), color = "gene") +
theme_bw() +
theme(legend.position="none") +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in c(1:8,10)){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0), labels = c(paste(grp_name[,1], collapse = " X ")))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr")
bp1
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0), labels = c(paste(grp_name[,1], collapse = " X "), NA))
bp1
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr",
labels = c(paste(grp_name[,1], collapse = " X "),
paste(grp_name[,2], collapse = " X "),
paste(grp_name[,3], collapse = " X ")))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "h", axis = "tblr",
labels = c(paste(grp_name[,1], collapse = " X "),
paste(grp_name[,2], collapse = " X "),
paste(grp_name[,3], collapse = " X ")))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "v", axis = "tblr",
labels = c(paste(grp_name[,1], collapse = " X "),
paste(grp_name[,2], collapse = " X "),
paste(grp_name[,3], collapse = " X ")))
plot_grid(bp1, bp2, bp3, ncol = 1, align = "v", axis = "tblr")
bp_list[[4]]
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
bp4 = plot_grid(bp_list[[4]], NULL, nrow = 1, rel_widths = c(8, 5))
plot_grid(bp1, bp2, bp3, bp4,
ncol = 1, align = "v", axis = "tblr")
plot_grid(bp1, bp2, bp3, bp4,
ncol = 1, align = "v", axis = "tblr")
bp_list[[5]]
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
# tissue$gene = gene_map$SYMBOL[match(tissue$gene,gene_map$UNIGENE)]
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c("tissue", "gene"), color = "gene") +
theme_bw() +
theme(legend.position="none") +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in c(1:8,10)){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp_list[[5]]
i = 5
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
gene_identify
bp_list[[1]]
tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)
agemap_result$MCTC_tbl[2304,]
grp_name
?ggboxplot
## 02. MC-TC identified genes
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
# tissue$gene = gene_map$SYMBOL[match(tissue$gene,gene_map$UNIGENE)]
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c("tissue", "gene"), color = "gene", label = levels(tissue$gene)) +
theme_bw() +
theme(legend.position="none") +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in c(1:8,10)){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
## 02. MC-TC identified genes
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
# tissue$gene = gene_map$SYMBOL[match(tissue$gene,gene_map$UNIGENE)]
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c("tissue", "gene"), color = "gene", label = tissue$gene) +
theme_bw() +
theme(legend.position="none") +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in c(1:8,10)){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp_list[[5]]
## 02. MC-TC identified genes
tissue_gene_boxplot <- function(tissue_label, gene, tissue_name){
tissue1 = scale(agemap_data_list[[tissue_label[1]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[1]]])
tissue2 = scale(agemap_data_list[[tissue_label[2]]][,gene]) %>% data.frame()  %>% mutate(time =  agemap_label_list[[tissue_label[2]]])
tissue1.long = tissue1 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[1])
tissue2.long = tissue2 %>% tibble::rownames_to_column("ID") %>% tidyr::gather(., gene, expression, -c(ID, time), factor_key=TRUE) %>% mutate(tissue = tissue_name[2])
tissue = rbind(tissue1.long, tissue2.long)
# tissue$gene = gene_map$SYMBOL[match(tissue$gene,gene_map$UNIGENE)]
figure <- ggboxplot(tissue, x = "time", y = "expression",
add = "jitter", add.params = list(alpha = 0.6, size = 1),
facet.by = c("tissue", "gene"), color = "gene") +
theme_bw() +
theme(legend.position="none") +
ylim(c(-2,2)) +
stat_summary(fun = median, geom = "line", aes(group=1, color=gene), size = 1) +
ylab("") + xlab("")
return(figure)
}
grp_name = combn(c("Ms", "Ad", "Hi", "Sp", "S"), 2)
grp_num  = combn(1:5, 2)
bp_list <- c()
for (i in c(1:8,10)){
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
bp_list <-c(bp_list, list(tissue_gene_boxplot(tissue_num, gene_identify, tissue_name)))
}
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
bp4 = plot_grid(bp_list[[4]], NULL, nrow = 1, rel_widths = c(8, 5))
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
bp4 = plot_grid(bp_list[[4]], NULL, nrow = 1, rel_widths = c(8, 5))
bp5 = plot_grid(bp_list[[5]], NULL, nrow = 1, rel_widths = c(1, 12))
plot_grid(bp1, bp2, bp3, bp4, bp5,
ncol = 1, align = "v", axis = "tblr")
plot_grid(bp1, bp2, bp3, bp4, bp5,
ncol = 1, align = "v", axis = "tblr")
bp5 = plot_grid(bp_list[[5]], NULL, nrow = 1, rel_widths = c(1, 10))
plot_grid(bp1, bp2, bp3, bp4, bp5,
ncol = 1, align = "v", axis = "tblr")
bp5 = plot_grid(bp_list[[5]], NULL, nrow = 1, rel_widths = c(1, 8))
plot_grid(bp1, bp2, bp3, bp4, bp5,
ncol = 1, align = "v", axis = "tblr")
bp_list[[6]]
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
bp4 = plot_grid(bp_list[[4]], NULL, nrow = 1, rel_widths = c(8, 5))
bp5 = plot_grid(bp_list[[5]], NULL, nrow = 1, rel_widths = c(1, 8))
bp6 = plot_grid(bp_list[[6]], NULL, nrow = 1, rel_widths = c(4, 8))
plot_grid(bp1, bp2, bp3, bp4, bp5, bp6,
ncol = 1, align = "v", axis = "tblr")
plot_grid(bp1, bp2, bp3, bp4, bp5, bp6,
ncol = 1, align = "v", axis = "tblr")
bp_list[[7]]
bp_list[[8]]
bp_list[[10]]
bp_list[[9]]
bp1 = plot_grid(bp_list[[1]], NULL, nrow = 1, rel_widths = c(13, 0))
bp2 = plot_grid(bp_list[[2]], NULL, nrow = 1, rel_widths = c(3, 9))
bp3 = plot_grid(bp_list[[3]], NULL, nrow = 1, rel_widths = c(7, 6))
bp4 = plot_grid(bp_list[[4]], NULL, nrow = 1, rel_widths = c(8, 5))
bp5 = plot_grid(bp_list[[5]], NULL, nrow = 1, rel_widths = c(1, 8))
bp6 = plot_grid(bp_list[[6]], NULL, nrow = 1, rel_widths = c(4, 8))
bp7 = plot_grid(bp_list[[7]], NULL, nrow = 1, rel_widths = c(5, 7))
bp8 = plot_grid(bp_list[[8]], NULL, nrow = 1, rel_widths = c(7, 6))
bp10 = plot_grid(bp_list[[9]], NULL, nrow = 1, rel_widths = c(5, 7))
plot_grid(bp1, bp2, bp3, bp4, bp5, bp6, bp7, bp8, bp10,
ncol = 1, align = "v", axis = "tblr")
ggsave(supfig1, width = 11, height = 30, unit = "in", file = "supfig1_mcmi.svg")
supfig1 = plot_grid(bp1, bp2, bp3, bp4, bp5, bp6, bp7, bp8, bp10,
ncol = 1, align = "v", axis = "tblr")
ggsave(supfig1, width = 11, height = 30, unit = "in", file = "supfig1_mcmi.svg")
ggsave(supfig1, width = 20, height = 30, unit = "in", file = "supfig1_mcmi.svg")
supfig1_p1 = plot_grid(bp1, bp2, bp3, bp4, bp5,
ncol = 1, align = "v", axis = "tblr")
supfig1_p2 = plot_grid(bp6, bp7, bp8, bp10,
ncol = 1, align = "v", axis = "tblr")
ggsave(supfig1_p1, width = 20, height = 15, unit = "in", file = "supfig1_mcmi_p1.svg")
ggsave(supfig1_p2, width = 20, height = 12, unit = "in", file = "supfig1_mcmi_p2.svg")
bp5
i = 5
tissue_num  = grp_num[,i]
tissue_name = grp_name[,i]
gene_identify = which(agemap_result$MCTC_tbl$qval < 0.05 & agemap_result$pairs_MI_tbl_list[[i]]$qval < 0.05)
gene_identify
agemap_result$MCTC_tbl[2304,]
supfig1 = plot_grid(bp1, bp2, bp3, bp4, bp5, bp6, bp7, bp8, bp10,
ncol = 1, align = "v", axis = "tblr")
ggsave(supfig1, width = 20, height = 15, unit = "in", file = "supfig1_mcmi_p1.svg")
ggsave(supfig1, width = 20, height = 30, unit = "in", file = "supfig1_mcmi.svg")
grp_name[9,]
grp_name
load("C:/Users/zou19/OneDrive - University of Pittsburgh/Ongoing_Project/Methodology/202203_multi_class_correlation/20220719_package/MSCC/inst/script_paper/agemap/agemap_result.RData")
View(agemap_result$minMCC_tbl)
View(agemap_result$MCTC_tbl)
MCTC_tbl["Mm.27896",]
agemap_result$MCTC_tbl["Mm.27896",]
agemap_result$MCTC_tbl["Mm.27897",]
load("C:/Users/zou19/OneDrive - University of Pittsburgh/Ongoing_Project/Methodology/202203_multi_class_correlation/20220719_package/MSCC/data/agemap.RData")
library(org.Mm.eg.db)
gene_map <- select(org.Mm.eg.db, keys=colnames(agemap_data_list[[1]]),
columns=c("GENENAME","SYMBOL"), keytype="UNIGENE")
View(gene_map)
agemap_result$pairs_MI_tbl_list$`1:2`
agemap_result$pairs_MI_tbl_list$`1:2`["Mm.27897",]
agemap_result$pairs_MI_tbl_list$`1:2`["Mm.27897",]$stat
sapply(agemap_result$pairs_MI_tbl_list, function(x) x["Mm.27897",]$stat)
range(sapply(agemap_result$pairs_MI_tbl_list, function(x) x["Mm.27897",]$stat))
range(sapply(agemap_result$pairs_MI_tbl_list, function(x) x["Mm.27897",]$qvalue))
range(sapply(agemap_result$pairs_MI_tbl_list, function(x) x["Mm.27897",]$qval))
agemap_result$MCTC_tbl["Mm.27897",]
